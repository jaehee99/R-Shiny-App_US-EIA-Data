---
title: "Group Project"
author: "Christopher Hopkins"
date: "4/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(httr)
library(keyring)
library(devtools)
library(blsAPI) #BLS API
library(rjson)
library(eia) #Energy API
library(lubridate)
```
*For bls data we will do 
Chris: 14 first states in alphabetical order.
Santiago: 14-26 states alphabetical order
Jaehee: 26-39 states...
David: 39-.... 


```{r}
#BLS dataframe
data<-list(seriesid = c("LAUST020000000000003", "LAUST010000000000003"))
blsAPI(data , 2, TRUE)->test
test

#Example of how to clean BLS dataframe
test %>% 
  mutate(seriesID = case_when(
    str_detect(seriesID, "LAUST020000000000003") ~ "Alabama-Unemployment",
    str_detect(seriesID, "LAUST010000000000003") ~ "Alaska-Unemployment"
  )) %>% 
  separate(seriesID, c("State", "Type"), sep = "-") %>% 
  pivot_wider(names_from = "Type",
              values_from = "value")


#EIA dataframe 
eia_set_key("8a87a727635f5c834e2799cd76fcb820")
eia_data <- c("ELEC.PRICE.AL-IND.M", "ELEC.PRICE.AK-ALL.M" )
eia_series(eia_data)->df
df$data

#Example of how to clean EIA dataframe
state_names <- c("Alabama", "Alaska")

df %>% 
  select(data)->df

df %>% 
  mutate(data = map(df$data, ~.x %>% 
  mutate(
         month = month(month, label = TRUE))))->df

df %>% 
  mutate(data = Map(cbind, df$data, state=state_names))->df

df$data

```

